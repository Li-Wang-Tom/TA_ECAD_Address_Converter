# TA_ECAD_Address_Converter

## 概要

Excel表からPLCアドレス、名称、機器をCSV形式で自動抽出するツール

## 対応フォーマット

- **パターン①**: 「種類 + CH + BIT」方式
- **パターン②**: 「I/O + ｺﾒﾝﾄ」方式

## 入力Excelの条件

### 基本条件

シート名の先頭に「★」が付いているもののみ対象

### パターン①：種類 + CH + BIT 方式

| 要素            | 抽出対象              | 出力先（CSV列） |
| ------------- | ----------------- | --------- |
| 種類 / CH / BIT | 下にある16点を結合してアドレス化 | C列（アドレス）  |
| 名称            | 下にある16点（全角カナ変換）   | A列（名称）    |
| 機器            | 下にある16点           | B列（機器）    |

### パターン②：I/O + ｺﾒﾝﾄ + 抽出用 方式

| 要素      | 抽出対象                    | 出力先（CSV列） |
| ------- | ----------------------- | --------- |
| I/O     | 結合セルの下2セルを結合（アドレス）      | C列（アドレス）  |
| ｺﾒﾝﾄ    | I/Oの1行下のセル（名称）          | A列（名称）    |
| 機器      | 抽出用の所の行き先               | B列（機器）    |
| COMスキップ | 「COM」含むI/O行の16点下をスキップ対象 | 処理対象外     |

## 共通仕様

### 処理ルール

- **1ブロック = 常に16点**
- **空白行10行で探索打ち切り**
- **アドレスは数値昇順**（例：R100 → R110）
- **16点ごとに空行を挿入**

### 出力CSVファイル名規則

- **入力**: 「01_入出力 ◯◯ デバイスリスト ～.xlsx」
- **出力**: 「◯◯_ECAD IOアドレス転記表.csv」

## 使用方法

### 手順

1. 対象のExcelファイルと同じフォルダに `plc_address_converter.py` を配置
2. Pythonスクリプトを起動（ダブルクリック実行）
3. CSVファイルが自動生成される

### 実行コマンド

```cmd
cd "C:\path\to\excel\files"
python plc_address_converter.py
```

## 出力結果

### CSV構成

```csv
名称,機器,アドレス
センサー1,リミットスイッチ,X000
センサー2,近接センサー,X001
...
```

### 注意事項

- シート名に「★」がない場合は処理対象外
- 16点単位での処理のため、途中の欠番は空行として出力
- 全角カナ変換は名称のみ適用