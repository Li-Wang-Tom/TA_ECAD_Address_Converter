# TA_ECAD_Address_Converter

Excel表からPLCアドレス、名称、機器をCSV形式で自動抽出するPythonツールです。  
ECAD設計業務でのアドレス転記作業を効率化します。

## 🎯 主な機能

- **Excel自動読み込み** - 「01_入出力」で始まるファイルを自動検出
- **複数パターン対応** - 種類+CH+BIT方式、I/O+コメント方式に対応
- **アドレス自動生成** - 16点ブロック単位でのアドレス処理
- **全角カナ変換** - 半角カナを全角カナに自動変換
- **数値昇順ソート** - アドレス番号順での自動整列

## 💻 動作環境

- Python 3.6+
- Windows/Linux/macOS
- 必要ライブラリ: pandas, openpyxl

## 📦 インストール方法

```bash
# 必要ライブラリをインストール
pip install pandas openpyxl

# スクリプトをダウンロード
# 対象Excelファイルと同じフォルダに配置
```

## 🚀 使用方法

### 基本手順

1. **Excelファイル準備**
   
   - ファイル名: 「01_入出力 ◯◯ デバイスリスト ～.xlsx」
   - シート名: 先頭に「★」を付加

2. **スクリプト実行**
   
   ```cmd
   cd "C:\path\to\excel\files"
   python TA_ECAD_Address_Converter.py
   ```

3. **結果確認**
   
   - 出力ファイル: 「◯◯_ECAD IOアドレス転記表.csv」

## 📋 対応フォーマット

### パターン① - 種類 + CH + BIT 方式

| 列ヘッダー | 処理内容           | 出力先    |
| ----- | -------------- | ------ |
| 種類    | 16点分のデバイス種別    | アドレス生成 |
| CH    | チャンネル番号        | アドレス生成 |
| BIT   | ビット番号          | アドレス生成 |
| 名称    | デバイス名称（全角カナ変換） | CSV A列 |
| 機器    | 機器種別           | CSV B列 |

### パターン② - I/O + コメント 方式

| 列ヘッダー | 処理内容         | 出力先    |
| ----- | ------------ | ------ |
| I/O   | 2セル結合でアドレス生成 | CSV C列 |
| コメント  | デバイス名称       | CSV A列 |
| 抽出用   | 機器情報         | CSV B列 |

## 🔧 処理仕様

### 共通ルール

- **16点ブロック処理** - 常に16点単位で処理
- **空白行検出** - 10行連続空白で探索終了
- **COMスキップ** - 「COM」含む行の16点下をスキップ
- **昇順ソート** - アドレス番号による自動ソート

### ファイル命名規則

```
入力: 01_入出力 テスト装置 デバイスリスト v1.0.xlsx
出力: テスト装置_ECAD IOアドレス転記表.csv
```

## 📄 出力CSV形式

```csv
名称,機器,アドレス
原点センサー,リミットスイッチ,X000
搬送完了センサー,近接センサー,X001
非常停止スイッチ,押ボタンスイッチ,X002
...
```

## 📂 ファイル構成

```
TA_ECAD_Address_Converter/
├─ TA_ECAD_Address_Converter.py         # メインスクリプト
├─ README.md                            # このファイル
├─ TA_ECAD_Address_Converter Manual.md  # 詳細マニュアル
├─ LICENSE                              # ライセンス
├─ TA_icon.ico                          # アプリケーションアイコン

```

## ⚠️ 注意事項

- **シート名要件**: 先頭に「★」が必須
- **ファイル名要件**: 「01_入出力」で開始する必要あり
- **配置場所**: ExcelファイルとPythonスクリプトを同一フォルダに配置
- **データ形式**: 16点ブロック単位での処理のため、途中欠番は空行出力

## 🐛 トラブルシューティング

### よくある問題

**Q: Excelファイルが見つからない**

- ファイル名が「01_入出力」で始まっているか確認
- Pythonスクリプトと同じフォルダにあるか確認

**Q: データが抽出されない**

- シート名の先頭に「★」があるか確認
- ヘッダー行の表記が正しいか確認

**Q: 文字化けが発生**

- UTF-8エンコーディングで保存されているか確認

## 🤝 貢献方法

1. リポジトリをフォーク
2. フィーチャーブランチを作成 (`git checkout -b feature/amazing-feature`)
3. 変更をコミット (`git commit -m 'Add amazing feature'`)
4. ブランチにプッシュ (`git push origin feature/amazing-feature`)
5. プルリクエストを作成

## 📝 License

This project is licensed under the MIT License - see the [LICENSE](https://claude.ai/chat/LICENSE) file for details.

## 👨‍💻 作者

**TA Development Team**

- GitHub: [@Li-Wang-Tom](https://github.com/Li-Wang-Tom)

## 🙏 謝辞

- **Python コミュニティ** - 強力なデータ処理環境
- **pandas 開発チーム** - 優秀なデータ分析ライブラリ
- **openpyxl プロジェクト** - Excel操作機能

ECAD設計業務の効率化にご協力いただいた全ての方に感謝します！



本项目的开发离不开以下优秀的开源项目和社区支持：

- **Python 社区** - 为我们提供了强大的数据处理环境
- **pandas 开发团队** - 提供了优秀的数据分析库
- **openpyxl 项目** - 提供了Excel操作功能

感谢所有为ECAD设计业务效率化做出贡献的人们！

谢谢大家！🎉
